<html>
  <head></head>
  <body>
    <script type="text/javascript" src="../target/chatkit.js"></script>
    <script type="text/javascript">
      const tokenProvider = new Chatkit.TokenProvider({
        authEndpoint: "https://us1-staging.pusherplatform.io/services/chatkit_token_provider/v1/80215247-1df3-4956-8ba8-9744ffd12164/token?instance_id=v1:us1-staging:80215247-1df3-4956-8ba8-9744ffd12164",
        userId: "ham",
      })

      const chatManager = new Chatkit.ChatManager({
        instanceId: 'v1:us1-staging:80215247-1df3-4956-8ba8-9744ffd12164',
        tokenProvider: tokenProvider,
      });

      chatManager.connect({
        delegate: {
          userStartedTyping: (room, user) => {
            console.log(`User ${user.id} started typing in room ${room.name}`);
          },
        },
        onSuccess: (currentUser) => {
          console.log("Successful connection", currentUser);

          const roomToSubscribeTo = currentUser.rooms[0];

          if (roomToSubscribeTo) {
            console.log("Going to subscribe to", roomToSubscribeTo);
            currentUser.subscribeToRoom(roomToSubscribeTo);
          } else {
            console.log("No rooms to subscribe to");
          }
        },
        onError: (error) => {
          console.log("Error on connection");
        }
      });
    </script>
  </body>
</html>
