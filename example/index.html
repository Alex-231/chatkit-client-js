<html>
  <head></head>
  <body>
    <script type="text/javascript" src="../target/chatkit.js"></script>
    <script type="text/javascript">
      const tokenProvider = new Chatkit.TokenProvider({
        authEndpoint: "https://us1.pusherplatform.io/services/chatkit_token_provider/v1/dc9ef674-4afb-43e8-94a5-438f47c02ea6/token?instance_id=v1:us1:dc9ef674-4afb-43e8-94a5-438f47c02ea6",
        userId: "ham",
      })

      const chatManager = new Chatkit.ChatManager({
        instanceId: 'v1:us1:dc9ef674-4afb-43e8-94a5-438f47c02ea6',
        tokenProvider: tokenProvider,
      });

      chatManager.connect({
        onSuccess: (currentUser) => {
          console.log("Successful connection", currentUser);

          const roomToSubscribeTo = currentUser.rooms[0];

          if (roomToSubscribeTo) {
            console.log("Going to subscribe to", roomToSubscribeTo);
            currentUser.subscribeToRoom(roomToSubscribeTo);
          } else {
            console.log("No rooms to subscribe to");
          }
        },
        onError: (error) => {
          console.log("Error on connection");
        }
      });
    </script>
  </body>
</html>
